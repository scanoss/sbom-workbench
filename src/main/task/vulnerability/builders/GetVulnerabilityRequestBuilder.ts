import * as VulnerabilitiesMessages from '../../grpc/scanoss/api/vulnerabilities/v2/scanoss-vulnerabilities_pb';
import { IGetVulnerabilities } from "../IVulnerabilities/IGetVulnerabilities";

export class GetVulnerabilityRequestBuilder {
  public static build(raw: IGetVulnerabilities): VulnerabilitiesMessages.VulnerabilityRequest {
    const request = new VulnerabilitiesMessages.VulnerabilityRequest();
    for (const item of raw.purls) {
      const purl = new VulnerabilitiesMessages.VulnerabilityRequest.Purls()
      purl.setPurl(item.purl);
      if (item?.requirement) purl.setRequirement(item.requirement)
      request.addPurls(purl)
    }
    return request;
  }
}
