import { ComponentVulnerability } from 'main/model/entity/ComponentVulnerability';
import { SourceType } from '../../api/dto';
import { modelProvider } from './ModelProvider';

class VulnerabilityService {
  public async getAll(type: SourceType): Promise<ComponentVulnerability[]> {
    const response = type === SourceType.detected
                    ? await modelProvider.model.vulnerability.getAllDetected()
                    : await modelProvider.model.vulnerability.getAllIdentified();
    return response;
  }
}

export const vulnerabilityService = new VulnerabilityService();
